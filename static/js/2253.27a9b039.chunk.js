"use strict";(self.webpackChunkmintbox_app=self.webpackChunkmintbox_app||[]).push([[2253],{1036:function(e,t,n){function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ",r="";try{r=new Date(e.replace(" ","T"))}catch(u){r=new Date(e)}if(isNaN(r.getTime()))return e;var a=new Array;a[0]="Jan",a[1]="Feb",a[2]="Mar",a[3]="Apr",a[4]="May",a[5]="Jun",a[6]="Jul",a[7]="Aug",a[8]="Sep",a[9]="Oct",a[10]="Nov",a[11]="Dec";var o=r.getDate();o<10&&(o="0"+o);var s=r.getHours(),i=r.getMinutes(),c=s>=12?"pm":"am",l=(s=(s%=12)||12,i=i<10?"0"+i:i,"date"===t?a[r.getMonth()]+n+r.getFullYear():o+n+a[r.getMonth()]+n+r.getFullYear());return l}function a(e,t){return e.setMonth(e.getMonth()+t),e}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)return r(new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),t)).toISOString());var n=new Date,o=new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),1)),s=Math.abs(o-n),i=Math.ceil(s/864e5);return r(i<27?new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),2)).toISOString():new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),1)).toISOString())}n.d(t,{Ux:function(){return o},p6:function(){return r}})},2253:function(e,t,n){n.r(t),n.d(t,{default:function(){return j}});var r=n(4165),a=n(1413),o=n(5861),s=n(9439),i=n(2791),c=n(1974),l=n(2102),u=n(7811),d=n(8820),p=n(3853),g=n(6825),h=n(81),x=n(8848),m=n(6960),f=n(9964),y=n(3411),Z=n(1036),v=n(6355),b=n(4561),w=n(2265),k=n(184);function j(e){var t=e.location.state,n=t.fundData||{},j=i.useState(Number((new Date).getDate())<28?(new Date).getDate():28),I=(0,s.Z)(j,2),N=I[0],T=I[1],S=i.useState({}),C=(0,s.Z)(S,2),D=C[0],P=C[1],A=i.useState(!0),V=(0,s.Z)(A,2),F=V[0],q=V[1],G=i.useState(!1),M=(0,s.Z)(G,2),O=M[0],B=M[1],R=(0,i.useState)(!1),J=(0,s.Z)(R,2),Y=J[0],E=J[1],z=(0,i.useState)(!1),L=(0,s.Z)(z,2),U=L[0],_=L[1];i.useEffect((0,o.Z)((0,r.Z)().mark((function s(){return(0,r.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:x.Z.get(x.Z.model.user).then(function(){var t=(0,o.Z)((0,r.Z)().mark((function t(n){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(n.userData),t.next=3,x.Z.get(x.Z.model.clientData).then(function(){var t=(0,o.Z)((0,r.Z)().mark((function t(o){var s,i,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==o){t.next=14;break}return t.next=3,h.Z.getClient(n.userData.id).then((function(e){return e}));case 3:if(!0!==(s=t.sent).type){t.next=12;break}return i=JSON.parse(s.data),c=i.reduce((function(e,t){return(0,a.Z)((0,a.Z)({},e),t)}),{}),console.log("Get Client API :",c),t.next=10,x.Z.set(x.Z.model.clientData,JSON.stringify(c));case 10:0===c.SmallcaseInfo.length&&e.history.replace({pathname:"/link-demat",state:{ClientId:s.Client[0].ClientId,type:3}}),q(!1);case 12:t.next=16;break;case 14:0===o.SmallcaseInfo.length&&e.history.replace({pathname:"/link-demat",state:{ClientId:o.Client[0].ClientId,type:3}}),q(!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log("fund:",n,t);case 2:case"end":return s.stop()}}),s)}))),[]);var H=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={clientId:D.id,goalPresentValue:"retirement"===t.type?0:Number(t.presentCost),tenure:Number(t.goalDue),initialInvestment:t.oneTime+t.sip*t.frequency,yearlyIncrementalInvestment:Number(t.monthlyIncrease),goalName:t.goalName,goalTargetCorpus:Number(t.finalCorpus),targetXIRR:Number(t.annR),inflation:"education"===t.type?10:"house"===t.type?8:"custom"===t.type?t.inflation:6,lumpsumInvestment:Number(t.oneTime),recurringInvestment:Number(t.sip),goalType:Number(t.id)},console.log("final",n),e.prev=2,B(!0),e.next=6,h.Z.updateGoal(n).then((function(e){return e}));case 6:if("success"!==(a=e.sent).data.Result){e.next=13;break}return m.Am.success("Goal created"),e.next=11,K(a.data.GoalId);case 11:e.next=15;break;case 13:m.Am.error("Goal with this name is already created!!"),B(!1);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),m.Am.error(e.t0),B(!1);case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var a=(0,o.Z)((0,r.Z)().mark((function a(o){var s,i,c,l,u,d;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=o.order,i=o.goalId,c=o.clientId,l={clientId:c,mintboxId:n.MintboxId,goalId:Number(i),transactionType:1,fromFundCode:"",toFundCode:"",folioNumber:"",sipAmount:Number(t.sip),units:0,LumpsumAmount:Number(t.oneTime),sipDate:N,investedAmount:s.orderBatches[0].buyAmount,investmentDate:s.orderBatches[0].completedDate,frequency:1===t.frequency?12:12===t.frequency?1:t.frequency},console.log("Save trnx log",l),r.next=5,h.Z.saveTransactionLogs(l).then((function(e){return e}));case 5:return u=r.sent,console.log("Save Trx log API response",JSON.stringify(u)),d={clientId:c,mintboxId:n.MintboxId,goalId:Number(i),smallcaseAuthToken:s.smallcaseAuthToken,broker:s.broker,transactionId:s.transactionId,data:{batches:s.orderBatches}},console.log("Save small case order",JSON.stringify(d)),r.next=11,h.Z.saveSmallCaseOrder(c,JSON.stringify(d)).then((function(e){return e}));case 11:if(!r.sent.type){r.next=28;break}return r.next=15,x.Z.remove(x.Z.model.portfolio);case 15:return r.next=17,x.Z.remove(x.Z.model.portfolioXirr);case 17:return r.next=19,x.Z.remove(x.Z.model.portfolioPerformance);case 19:return r.next=21,x.Z.remove(x.Z.model.assetAllocation);case 21:return r.next=23,x.Z.remove(x.Z.model.transactions);case 23:return r.next=25,x.Z.remove(x.Z.model.sip);case 25:e.history.push("/portfolio/success"),r.next=29;break;case 28:e.history.push("/portfolio/failed");case 29:case"end":return r.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),X=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var a,s,i,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.securities,s=t.goalId,i={intent:"TRANSACTION",orderConfig:{type:"SECURITIES",securities:a}},console.log("order",i),e.next=5,h.Z.getSmallcaseTransactionId(i,"",n.MintboxId||0,s).then((function(e){return e}));case 5:if(!(c=e.sent).type){e.next=23;break}if(console.log("Trx id =>>",c.data.data.transactionId),e.prev=8,void 0!==window.sc){e.next=13;break}return console.log("Initializing Smallcase"),e.next=13,(0,w.B3)();case 13:return e.next=15,window.sc.triggerTransaction({transactionId:c.data.data.transactionId}).then(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),"COMPLETED"!==t.orderBatches[0].status){e.next=10;break}return e.prev=2,e.next=5,x.Z.get(x.Z.model.user).then(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W({order:t,clientId:n.userData.id,goalId:s});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log("error getting user",e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){if("market_closed"===e.message)return console.log("mkt closed"),"market_closed";"user_cancelled"!==e.message&&m.Am.error("Something went wrong! Try again.")}));case 15:return e.abrupt("return",e.sent);case 18:e.prev=18,e.t0=e.catch(8),m.Am.error("Something went wrong! Try again.");case 21:e.next=24;break;case 23:console.log("Error getting Transaction Id");case 24:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n,a){var o,s,i,c,l,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.getETFsById(t.toString()).then((function(e){return e}));case 2:if(o=e.sent,console.log(o),!o.type){e.next=27;break}return console.log(o),s={},n.map((function(e){s[e.Symbol]=e.CurrentWeightage/100})),i={},o.data.map((function(e){i[e.Symbol]=1*e.NAV})),c={weights:s,currentNav:i,investment:a},console.log(JSON.stringify(c)),e.next=14,h.Z.getETFQuantities(JSON.stringify(c)).then((function(e){return e}));case 14:if(!(l=e.sent).type){e.next=23;break}return u=l.data.Result,u=JSON.parse(u).data,console.log(l),console.log(u),e.abrupt("return",u);case 23:B(!1),m.Am.error("Error");case 25:e.next=29;break;case 27:B(!1),m.Am.error("Error");case 29:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),K=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(a){var o,s,i,c,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),o=t.oneTime+t.sip*t.frequency,s=n.Constituents.map((function(e){return e.Symbol})),e.next=5,Q(s,n.Constituents,o);case 5:return i=e.sent,c=Object.entries(i).map((function(e){return{ticker:e[0],quantity:e[1]+"",type:"BUY"}})),console.log(c),e.next=10,X({securities:c,goalId:a});case 10:l=e.sent,console.log(l),"market_closed"===l&&_(!0),B(!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=i.useState(N),t=(0,s.Z)(e,2),n=t[0],r=t[1];return(0,k.jsxs)(g.Z,{className:"bottom-drawer",show:Y,onHide:function(){return E(!1)},children:[(0,k.jsxs)(g.Z.Body,{children:[(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[1,2,3,4,5,6,7].map((function(e){return(0,k.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+u.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?u.Z.getPropertyValue("--white"):u.Z.getPropertyValue("--grey"),background:e===n?u.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))}),(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[8,9,10,11,12,13,14].map((function(e){return(0,k.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+u.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?u.Z.getPropertyValue("--white"):u.Z.getPropertyValue("--grey"),background:e===n?u.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))}),(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[15,16,17,18,19,20,21].map((function(e){return(0,k.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+u.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?u.Z.getPropertyValue("--white"):u.Z.getPropertyValue("--grey"),background:e===n?u.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))}),(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[22,23,24,25,26,27,28].map((function(e){return(0,k.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+u.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?u.Z.getPropertyValue("--white"):u.Z.getPropertyValue("--grey"),background:e===n?u.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))})]}),(0,k.jsxs)(g.Z.Footer,{children:[(0,k.jsx)("button",{className:"outlineButton",onClick:function(){return E(!1)},children:"Close"}),(0,k.jsx)("button",{className:"solidButton",onClick:function(){T(n),E(!1)},children:"Confirm"})]})]})},ee=function(){return(0,k.jsxs)(g.Z,{className:"bottom-drawer",show:U,onHide:function(){return _(!1)},keyboard:!1,children:[(0,k.jsx)(g.Z.Body,{children:(0,k.jsxs)("div",{style:{display:"flex",gap:"4%"},children:[(0,k.jsx)(p.vlc,{size:20,className:"secondaryGreen"}),(0,k.jsx)("div",{className:"bodyTextDark",style:{flex:1},children:"You cannot place order outside of market hours. We will soon be launching a solution that lets you place post-market orders. Till then, see you when the markets opens!"})]})}),(0,k.jsx)(g.Z.Footer,{children:(0,k.jsx)("button",{className:"solidButton",onClick:function(){return _(!1)},children:"Close"})})]})};return void 0===t?(e.history.push("/Goals"),(0,k.jsx)(k.Fragment,{})):(0,k.jsxs)("div",{className:"mainContainer",children:[(0,k.jsx)(l.Z,{navigation:e.history,header:t.header}),(0,k.jsx)("div",{className:"dataContainer",children:F?(0,k.jsx)(b.Z,{}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"header1dark",style:{paddingTop:"6%"},children:"Today's investment"}),(0,k.jsxs)("div",{className:"smallTextDark",style:{marginTop:"1%"},children:["(",t.oneTime>0?"One-time lumpsum +":""," First SIP installment)"]}),(0,k.jsxs)("div",{style:{display:"flex",marginTop:"4%",alignItems:"center",borderBottom:"1px solid "+u.Z.getPropertyValue("--light"),fontSize:"24px",fontWeight:"500",color:u.Z.getPropertyValue("--grey"),lineHeight:"33.6px"},children:[(0,k.jsx)("span",{style:{opacity:"0.6"},children:(0,y.A)(t.oneTime+t.sip*t.frequency)}),(0,k.jsx)(v.kUi,{size:20,className:"secondaryGreen",style:{marginLeft:"8%"}})]}),(0,k.jsxs)("div",{style:{marginTop:"40px"},children:[(0,k.jsx)(p.vlc,{size:24,className:"secondaryGreen"}),(0,k.jsxs)("div",{className:"bodyTextLight",style:{marginTop:"2%"},children:[(0,k.jsx)("span",{style:{fontSize:"20px",fontWeight:"500",color:"#333333"},children:(0,c.Z)(N)})," of every month"]}),(0,k.jsxs)("div",{className:"header2dark secondaryGreen",style:{marginTop:"1%"},onClick:function(){return E(!0)},children:["Change ",(0,k.jsx)(d.Td4,{size:12})]})]}),(0,k.jsxs)("div",{style:{marginTop:"40px",border:"1px solid "+u.Z.getPropertyValue("--light"),background:u.Z.getPropertyValue("--lightest"),borderRadius:"8px",padding:"4%"},children:[(0,k.jsx)("div",{className:"header2dark",children:"Note"}),(0,k.jsx)("div",{className:"bodyTextLight",style:{marginTop:"1%"},children:1===t.frequency?(0,k.jsxs)(k.Fragment,{children:["The frequency of your sip will be every month of amount ",(0,k.jsx)("span",{className:"secondaryGreen",children:(0,y.A)(t.sip)}),(0,k.jsx)("br",{}),(0,k.jsx)("br",{}),"Your next SIP date is ",(0,k.jsx)("b",{children:(0,Z.Ux)(N)})]}):(0,k.jsxs)(k.Fragment,{children:["Your goal doesn't require a monthly SIP. Instead, the frequency of your SIP will be once in ",(0,k.jsx)("span",{className:"secondaryGreen",children:3===t.frequency?"three":6===t.frequency?"six":12===t.frequency?"twelve":""})," months of amount ",(0,k.jsx)("span",{className:"secondaryGreen",children:(0,y.A)(t.sip*t.frequency)}),(0,k.jsx)("br",{}),(0,k.jsx)("br",{}),"Your next SIP date is ",(0,k.jsx)("b",{children:(0,Z.Ux)(N,t.frequency)})]})})]})]})}),(0,k.jsx)("div",{className:"bodyTextLight",style:{position:"fixed",bottom:"70px",borderTop:"1px solid "+u.Z.getPropertyValue("--light"),padding:"2% 4%",backgroundColor:u.Z.getPropertyValue("--white")},children:"Note: The actual amount invested may be slightly different due to constantly changing prices"}),(0,k.jsx)("div",{className:"footer",children:(0,k.jsx)("button",{className:"solidButton",onClick:function(){return H()},children:"Confirm and Invest"})}),(0,k.jsx)(f.Z,{style:{color:"#fff",zIndex:1021},open:O,children:(0,k.jsx)(b.Z,{})}),(0,k.jsx)($,{}),(0,k.jsx)(ee,{})]})}}}]);
//# sourceMappingURL=2253.27a9b039.chunk.js.map