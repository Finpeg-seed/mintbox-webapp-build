"use strict";(self.webpackChunkmintbox_app=self.webpackChunkmintbox_app||[]).push([[2253],{1036:function(e,t,n){function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ",r="";try{r=new Date(e.replace(" ","T"))}catch(l){r=new Date(e)}if(isNaN(r.getTime()))return e;var a=new Array;a[0]="Jan",a[1]="Feb",a[2]="Mar",a[3]="Apr",a[4]="May",a[5]="Jun",a[6]="Jul",a[7]="Aug",a[8]="Sep",a[9]="Oct",a[10]="Nov",a[11]="Dec";var o=r.getDate();o<10&&(o="0"+o);var s=r.getHours(),i=r.getMinutes(),c=s>=12?"pm":"am",u=(s=(s%=12)||12,i=i<10?"0"+i:i,"date"===t?a[r.getMonth()]+n+r.getFullYear():o+n+a[r.getMonth()]+n+r.getFullYear());return u}function a(e,t){return e.setMonth(e.getMonth()+t),e}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)return r(new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),t)).toISOString());var n=new Date,o=new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),1)),s=Math.abs(o-n),i=Math.ceil(s/864e5);return r(i<27?new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),2)).toISOString():new Date(a(new Date((new Date).getFullYear(),(new Date).getMonth(),e),1)).toISOString())}n.d(t,{Ux:function(){return o},p6:function(){return r}})},2253:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var r=n(4165),a=n(1413),o=n(5861),s=n(9439),i=n(2791),c=n(1974),u=n(2102),l=n(7811),d=n(8820),p=n(3853),f=n(6825),g=n(81),h=n(8848),m=n(6960),y=n(9964),x=n(3411),b=n(1036),v=n(6355),Z=n(4561),w=n(2265),j=n(184);function k(e){var t=e.location.state,n=t.fundData||{},k=i.useState(Number((new Date).getDate())<28?(new Date).getDate():28),I=(0,s.Z)(k,2),N=I[0],T=I[1],S=i.useState({}),C=(0,s.Z)(S,2),D=C[0],P=C[1],O=i.useState(!0),A=(0,s.Z)(O,2),V=A[0],F=A[1],M=i.useState(!1),q=(0,s.Z)(M,2),G=q[0],B=q[1],E=(0,i.useState)(!1),R=(0,s.Z)(E,2),J=R[0],Y=R[1],z=(0,i.useState)(!1),L=(0,s.Z)(z,2),U=L[0],_=L[1];i.useEffect((0,o.Z)((0,r.Z)().mark((function s(){return(0,r.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:h.Z.get(h.Z.model.user).then(function(){var t=(0,o.Z)((0,r.Z)().mark((function t(n){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(n.userData),t.next=3,h.Z.get(h.Z.model.clientData).then(function(){var t=(0,o.Z)((0,r.Z)().mark((function t(o){var s,i,c;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==o){t.next=14;break}return t.next=3,g.Z.getClient(n.userData.id).then((function(e){return e}));case 3:if(!0!==(s=t.sent).type){t.next=12;break}return i=JSON.parse(s.data),c=i.reduce((function(e,t){return(0,a.Z)((0,a.Z)({},e),t)}),{}),console.log("Get Client API :",c),t.next=10,h.Z.set(h.Z.model.clientData,JSON.stringify(c));case 10:0===c.SmallcaseInfo.length&&e.history.replace({pathname:"/link-demat",state:{ClientId:s.Client[0].ClientId,type:3}}),F(!1);case 12:t.next=16;break;case 14:0===o.SmallcaseInfo.length&&e.history.replace({pathname:"/link-demat",state:{ClientId:o.Client[0].ClientId,type:3}}),F(!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log("fund:",n,t);case 2:case"end":return s.stop()}}),s)}))),[]);var H=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={clientId:D.id,goalPresentValue:"retirement"===t.type?0:Number(t.presentCost),tenure:Number(t.goalDue),initialInvestment:t.oneTime+t.sip*t.frequency,yearlyIncrementalInvestment:Number(t.monthlyIncrease),goalName:t.goalName,goalTargetCorpus:Number(t.finalCorpus),targetXIRR:Number(t.annR),inflation:"education"===t.type?10:"house"===t.type?8:"custom"===t.type?t.inflation:6,lumpsumInvestment:Number(t.oneTime),recurringInvestment:Number(t.sip),goalType:Number(t.id)},console.log("final",n),e.prev=2,B(!0),e.next=6,g.Z.updateGoal(n).then((function(e){return e}));case 6:if("success"!==(a=e.sent).data.Result){e.next=13;break}return m.Am.success("Goal created"),e.next=11,$(a.data.GoalId);case 11:e.next=15;break;case 13:m.Am.error("Goal with this name is already created!!"),B(!1);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),m.Am.error(e.t0),B(!1);case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var a=(0,o.Z)((0,r.Z)().mark((function a(o){var s,i,c,u,l,d;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=o.order,i=o.goalId,c=o.clientId,u={clientId:c,mintboxId:n.MintboxId,goalId:Number(i),transactionType:1,fromFundCode:"",toFundCode:"",folioNumber:"",sipAmount:Number(t.sip),units:0,LumpsumAmount:Number(t.oneTime),sipDate:N,investedAmount:s.orderBatches[0].buyAmount,investmentDate:s.orderBatches[0].completedDate,frequency:1===t.frequency?12:12===t.frequency?1:t.frequency},console.log("Save trnx log",u),r.next=5,g.Z.saveTransactionLogs(u).then((function(e){return e}));case 5:return l=r.sent,console.log("Save Trx log API response",JSON.stringify(l)),d={clientId:c,mintboxId:n.MintboxId,goalId:Number(i),smallcaseAuthToken:s.smallcaseAuthToken,broker:s.broker,transactionId:s.transactionId,data:{batches:s.orderBatches}},console.log("Save small case order",JSON.stringify(d)),r.next=11,g.Z.saveSmallCaseOrder(c,JSON.stringify(d)).then((function(e){return e}));case 11:if(!r.sent.type){r.next=28;break}return r.next=15,h.Z.remove(h.Z.model.portfolio);case 15:return r.next=17,h.Z.remove(h.Z.model.portfolioXirr);case 17:return r.next=19,h.Z.remove(h.Z.model.portfolioPerformance);case 19:return r.next=21,h.Z.remove(h.Z.model.assetAllocation);case 21:return r.next=23,h.Z.remove(h.Z.model.transactions);case 23:return r.next=25,h.Z.remove(h.Z.model.sip);case 25:e.history.push("/portfolio/success"),r.next=29;break;case 28:e.history.push("/portfolio/failed");case 29:case"end":return r.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),X=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var a,s,i,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.securities,s=t.goalId,i={intent:"TRANSACTION",orderConfig:{type:"SECURITIES",securities:a}},console.log("order",i),e.next=5,g.Z.getSmallcaseTransactionId(i,"",n.MintboxId||0,s).then((function(e){return e}));case 5:if(!(c=e.sent).type){e.next=23;break}if(console.log("Trx id =>>",c.data.data.transactionId),e.prev=8,void 0!==window.sc){e.next=13;break}return console.log("Initializing Smallcase"),e.next=13,(0,w.B3)();case 13:return e.next=15,window.sc.triggerTransaction({transactionId:c.data.data.transactionId}).then(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),"COMPLETED"!==t.orderBatches[0].status){e.next=10;break}return e.prev=2,e.next=5,h.Z.get(h.Z.model.user).then(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W({order:t,clientId:n.userData.id,goalId:s});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log("error getting user",e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){if("market_closed"===e.message)return console.log("mkt closed"),"market_closed";"user_cancelled"!==e.message&&m.Am.error("Something went wrong! Try again.")}));case 15:return e.abrupt("return",e.sent);case 18:e.prev=18,e.t0=e.catch(8),m.Am.error("Something went wrong! Try again.");case 21:e.next=24;break;case 23:console.log("Error getting Transaction Id");case 24:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n,a){var o,s,i,c,u,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Z.getETFsById(t.toString()).then((function(e){return e}));case 2:if(o=e.sent,console.log(o),!o.type){e.next=27;break}return console.log(o),s={},n.map((function(e){s[e.Symbol]=e.CurrentWeightage/100})),i={},o.data.map((function(e){i[e.Symbol]=1*e.NAV})),c={weights:s,currentNav:i,investment:a},console.log(JSON.stringify(c)),e.next=14,g.Z.getETFQuantities(JSON.stringify(c)).then((function(e){return e}));case 14:if(!(u=e.sent).type){e.next=23;break}return l=u.data.Result,l=JSON.parse(l).data,console.log(u),console.log(l),e.abrupt("return",l);case 23:B(!1),m.Am.error("Error");case 25:e.next=29;break;case 27:B(!1),m.Am.error("Error");case 29:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),$=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(a){var o,s,i,c,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),o=t.oneTime+t.sip*t.frequency,s=n.Constituents.map((function(e){return e.Symbol})),e.next=5,Q(s,n.Constituents,o);case 5:return i=e.sent,c=Object.entries(i).map((function(e){return{ticker:e[0],quantity:e[1]+"",type:"BUY"}})),console.log(c),e.next=10,X({securities:c,goalId:a});case 10:u=e.sent,console.log(u),"market_closed"===u&&_(!0),B(!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=i.useState(N),t=(0,s.Z)(e,2),n=t[0],r=t[1];return(0,j.jsxs)(f.Z,{className:"bottom-drawer",show:J,onHide:function(){return Y(!1)},children:[(0,j.jsxs)(f.Z.Body,{children:[(0,j.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[1,2,3,4,5,6,7].map((function(e){return(0,j.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+l.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?l.Z.getPropertyValue("--white"):l.Z.getPropertyValue("--grey"),background:e===n?l.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))}),(0,j.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[8,9,10,11,12,13,14].map((function(e){return(0,j.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+l.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?l.Z.getPropertyValue("--white"):l.Z.getPropertyValue("--grey"),background:e===n?l.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))}),(0,j.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[15,16,17,18,19,20,21].map((function(e){return(0,j.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+l.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?l.Z.getPropertyValue("--white"):l.Z.getPropertyValue("--grey"),background:e===n?l.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))}),(0,j.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"20px",paddingTop:"20px"},children:[22,23,24,25,26,27,28].map((function(e){return(0,j.jsx)("div",{onClick:function(){return r(e)},style:{border:"1px solid "+l.Z.getPropertyValue("--light"),borderRadius:"32px",height:"32px",width:"32px",textAlign:"center",paddingTop:"2px",color:e===n?l.Z.getPropertyValue("--white"):l.Z.getPropertyValue("--grey"),background:e===n?l.Z.getPropertyValue("--darkGreen"):"transparent"},children:e},e)}))})]}),(0,j.jsxs)(f.Z.Footer,{children:[(0,j.jsx)("button",{className:"outlineButton",onClick:function(){return Y(!1)},children:"Close"}),(0,j.jsx)("button",{className:"solidButton",onClick:function(){T(n),Y(!1)},children:"Confirm"})]})]})},ee=function(){return(0,j.jsxs)(f.Z,{className:"bottom-drawer",show:U,onHide:function(){return _(!1)},keyboard:!1,children:[(0,j.jsx)(f.Z.Body,{children:(0,j.jsxs)("div",{style:{display:"flex",gap:"4%"},children:[(0,j.jsx)(p.vlc,{size:20,className:"secondaryGreen"}),(0,j.jsx)("div",{className:"bodyTextDark",style:{flex:1},children:"You cannot place order outside of market hours. We will soon be launching a solution that lets you place post-market orders. Till then, see you when the markets opens!"})]})}),(0,j.jsx)(f.Z.Footer,{children:(0,j.jsx)("button",{className:"solidButton",onClick:function(){return _(!1)},children:"Close"})})]})};return void 0===t?(e.history.push("/Goals"),(0,j.jsx)(j.Fragment,{})):(0,j.jsxs)("div",{className:"mainContainer",children:[(0,j.jsx)(u.Z,{navigation:e.history,header:t.header}),(0,j.jsx)("div",{className:"dataContainer",children:V?(0,j.jsx)(Z.Z,{}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"header1dark",style:{paddingTop:"6%"},children:"Today's investment"}),(0,j.jsxs)("div",{className:"smallTextDark",style:{marginTop:"1%"},children:["(",t.oneTime>0?"One-time lumpsum +":""," First SIP installment)"]}),(0,j.jsxs)("div",{style:{display:"flex",marginTop:"4%",alignItems:"center",borderBottom:"1px solid "+l.Z.getPropertyValue("--light"),fontSize:"24px",fontWeight:"500",color:l.Z.getPropertyValue("--grey"),lineHeight:"33.6px"},children:[(0,j.jsx)("span",{style:{opacity:"0.6"},children:(0,x.A)(t.oneTime+t.sip*t.frequency)}),(0,j.jsx)(v.kUi,{size:20,className:"secondaryGreen",style:{marginLeft:"8%"}})]}),(0,j.jsxs)("div",{style:{marginTop:"40px"},children:[(0,j.jsx)(p.vlc,{size:24,className:"secondaryGreen"}),(0,j.jsxs)("div",{className:"bodyTextLight",style:{marginTop:"2%"},children:[(0,j.jsx)("span",{style:{fontSize:"20px",fontWeight:"500",color:"#333333"},children:(0,c.Z)(N)})," of every month"]}),(0,j.jsxs)("div",{className:"header2dark secondaryGreen",style:{marginTop:"1%"},onClick:function(){return Y(!0)},children:["Change ",(0,j.jsx)(d.Td4,{size:12})]})]}),(0,j.jsxs)("div",{style:{marginTop:"40px",border:"1px solid "+l.Z.getPropertyValue("--light"),background:l.Z.getPropertyValue("--lightest"),borderRadius:"8px",padding:"4%"},children:[(0,j.jsx)("div",{className:"header2dark",children:"Note"}),(0,j.jsx)("div",{className:"bodyTextLight",style:{marginTop:"1%"},children:1===t.frequency?(0,j.jsxs)(j.Fragment,{children:["The frequency of your sip will be every month of amount ",(0,j.jsx)("span",{className:"secondaryGreen",children:(0,x.A)(t.sip)}),(0,j.jsx)("br",{}),(0,j.jsx)("br",{}),"Your next SIP date is ",(0,j.jsx)("b",{children:(0,b.Ux)(N)})]}):(0,j.jsxs)(j.Fragment,{children:["Your goal doesn't require a monthly SIP. Instead, the frequency of your SIP will be once in ",(0,j.jsx)("span",{className:"secondaryGreen",children:3===t.frequency?"three":6===t.frequency?"six":12===t.frequency?"twelve":""})," months of amount ",(0,j.jsx)("span",{className:"secondaryGreen",children:(0,x.A)(t.sip*t.frequency)}),(0,j.jsx)("br",{}),(0,j.jsx)("br",{}),"Your next SIP date is ",(0,j.jsx)("b",{children:(0,b.Ux)(N,t.frequency)})]})})]})]})}),(0,j.jsx)("div",{className:"bodyTextLight",style:{position:"fixed",bottom:"70px",borderTop:"1px solid "+l.Z.getPropertyValue("--light"),padding:"2% 4%",backgroundColor:l.Z.getPropertyValue("--white")},children:"Note: The actual amount invested may be slightly different due to constantly changing prices"}),(0,j.jsx)("div",{className:"footer",children:(0,j.jsx)("button",{className:"solidButton",onClick:function(){return H()},children:"Confirm and Invest"})}),(0,j.jsx)(y.Z,{style:{color:"#fff",zIndex:1021},open:G,children:(0,j.jsx)(Z.Z,{})}),(0,j.jsx)(K,{}),(0,j.jsx)(ee,{})]})}},907:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},3878:function(e,t,n){function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},4942:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return r}})},5267:function(e,t,n){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},1413:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(4942);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},9439:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(3878);var a=n(181),o=n(5267);function s(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],s=!0,i=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(c){i=!0,a=c}finally{try{s||null==n.return||n.return()}finally{if(i)throw a}}return o}}(e,t)||(0,a.Z)(e,t)||(0,o.Z)()}},181:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(907);function a(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}}}]);
//# sourceMappingURL=2253.8750ea5f.chunk.js.map