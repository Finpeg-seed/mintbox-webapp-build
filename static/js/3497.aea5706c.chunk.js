"use strict";(self.webpackChunkmintbox_app=self.webpackChunkmintbox_app||[]).push([[3497],{2102:function(e,n,t){t(2791);var a=t(8820),r=t(9126),i=t(3853),s=t(8617),o=t(7811),c=t(184);n.Z=function(e){var n=e.header,t=e.navigation,l=e.screenType,d=e.backAction,u=void 0===d?function(){t.goBack()}:d,p=e.right,g=e.rightAction,f=void 0===g?function(){}:g,h=e.isWatchlisted,m=void 0!==h&&h,x=e.onWatchlistIconClick,y=void 0===x?function(){}:x,k=e.onShareIconClick,b=void 0===k?function(){}:k,v=e.onHeaderClick,Z=void 0===v?function(){}:v;return(0,c.jsxs)("div",{className:"mainHeader sticky-top",children:["Home"!==l&&(0,c.jsx)("div",{style:{marginRight:"4%",minWidth:"8%"},children:(0,c.jsx)(i.Ao2,{color:o.Z.getPropertyValue("--secondaryGreen"),size:24,onClick:function(){return u()}})}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)("span",{className:"screenTitle",onClick:function(){return Z()},children:n})}),(0,c.jsx)("div",{style:{display:"flex"},children:function(){switch(p){case"bookmark-share":return(0,c.jsxs)("span",{children:[m?(0,c.jsx)(r.vw0,{className:"secondaryGreen",size:24,onClick:y}):(0,c.jsx)(r.flH,{className:"secondaryGreen",size:24,onClick:y}),(0,c.jsx)(s.qyl,{className:"secondaryGreen",size:24,style:{marginLeft:"20px"},onClick:b})]});case"tip":return(0,c.jsxs)("span",{className:"header3dark secondaryGreen",onClick:function(){return f()},children:["Tip ",(0,c.jsx)(a.cuw,{size:10})]});default:return p?(0,c.jsx)("span",{className:"greenChipHeader",onClick:function(){f()},children:p}):(0,c.jsx)(c.Fragment,{})}}()})]})}},3497:function(e,n,t){t.r(n);var a=t(1413),r=t(4165),i=t(5861),s=t(9439),o=t(8848),c=t(2791),l=t(1276),d=t.n(l),u=t(6960),p=t(3593),g=t(81),f=t(7811),h=t(5676),m=t(2102),x=t(8820),y=t(4561),k=t(184);n.default=function(e){null===(n=e.location.state)||void 0===n||n.taxStatus;var n,t=c.useState(""),l=(0,s.Z)(t,2),b=l[0],v=l[1],Z=c.useState(""),j=(0,s.Z)(Z,2),C=j[0],D=j[1],N=c.useState("sign"),w=(0,s.Z)(N,2),S=w[0],R=w[1],P=c.useState(!0),I=(0,s.Z)(P,2),A=I[0],G=I[1],T=c.useState(!0),V=(0,s.Z)(T,2),B=V[0],F=V[1],E=c.useState({}),W=(0,s.Z)(E,2),z=W[0],O=W[1],U=c.useState({}),L=(0,s.Z)(U,2),H=L[0],J=L[1],M=c.useState(!1),q=(0,s.Z)(M,2),Y=q[0],_=q[1],K=c.useRef(null),Q=c.useRef(null);c.useEffect((function(){ne()}),[C]);var X=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var a,i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=18;break}return a=n,(i=new FormData).append("file",a),e.prev=4,e.next=7,g.Z.uploadDoc(z.id,i).then((function(e){return e}));case 7:s=e.sent,console.log(s.data),s.type?s.data.DocumentId?D(s.data.DocumentId):(console.log("ERR : 2",s.msg),u.Am.error("try again...")):(console.log("ERR : 1",s.msg),u.Am.error("try again...")),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),console.log("ERR : c",e.t0),u.Am.error("try again...");case 16:e.next=19;break;case 18:alert("Please Select File first");case 19:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(n,t){return e.apply(this,arguments)}}(),$=function(e){v(URL.createObjectURL(e.target.files[0]));var n=e.target.files[0];X(n,"sign")},ee=function(){var e,n,t,a=Q.getTrimmedCanvas().toDataURL("image/png");console.log(a),(e=a,n="sign.png",t="image/png",fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return new File([e],n,{type:t})}))).then((function(e){X(e,"sign")}))},ne=function(){F(""===C||null===C)};function te(e){return console.log(e),e=e.split(" / ").reverse().join("-")}var ae=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.get(o.Z.model.clientData).then(function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var i,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t){e.next=7;break}return e.next=3,g.Z.getClient(n).then((function(e){return e}));case 3:!0===(i=e.sent).type&&(s=JSON.parse(i.data),c=s.reduce((function(e,n){return(0,a.Z)((0,a.Z)({},e),n)}),{}),console.log("Get Client API :",c),_(1===c.Client[0].IsProfileComplete),o.Z.set(o.Z.model.clientData,JSON.stringify(c))),e.next=8;break;case 7:_(1===t.Client[0].IsProfileComplete);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),re=function(){var n=(0,i.Z)((0,r.Z)().mark((function n(){var t,a,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log(Y),!Y){n.next=5;break}return u.Am.error("Profile already completed"),e.history.push("/dashboard"),n.abrupt("return");case 5:return a={client:{clientId:z.id,clientName:H.name,mobileNumber:"2"===H.taxStatus?H.PersonalDetails.phone:"",gender:"0"===H.PersonalDetails.gender?1:2,dateOfBirth:new Date(te(H.PersonalDetails.dob)),pan:"1"===H.taxStatus?"":H.panData.pan,kycStatus:"1"===H.taxStatus?H.GuardianPan.kycRegistered:H.panData.kycRegistered,taxStatus:"0"===H.taxStatus?1:"1"===H.taxStatus?2:H.BankDetails.type,guardianPAN:"1"===H.taxStatus?H.GuardianPan.pan:"",guardianName:"1"===H.taxStatus?H.GuardianName:"",guardianDOB:"1"===H.taxStatus?new Date(te(H.GuardianName)):new Date("0000-00-00"),panFileId:H.doc.panID,bankFileId:H.doc.chequeID,signFileId:C},addresses:[{clientId:z.id,address1:H.AddressDetails.line1,address2:H.AddressDetails.line2,city:H.AddressDetails.city,state:H.AddressDetails.state,pincode:H.AddressDetails.pincode,countryId:H.AddressDetails.country.CountryCode}],fatcas:[{clientId:z.id,pan:"1"===H.taxStatus?H.GuardianPan.pan:H.panData.pan,birthCountryId:0,residentCountryId:0,isTaxResident:"YES"===H.isTaxResident,politicalExposure:H.politicalExposure,annualIncomeSlab:Number(H.Fatca.income.IncomeCode),sourceofWealth:Number(H.Fatca.wealth.SourceCode),occupation:H.Fatca.occupation.OccupationCode,identificationType:""}],nominees:"1"!==H.taxStatus&&"0"===(null===(t=H.Nominee)||void 0===t?void 0:t.addNominee)?[{clientId:z.id,name:H.Nominee.noName,relation:H.Nominee.noRelation,dateOfBirth:new Date(te(H.Nominee.noDob)),allocation:100,guardianName:H.Nominee.noGuardian}]:[],bankInfo:{clientId:z.id,bankId:H.BankDetails.UID,bankName:H.BankDetails.name,accountType:H.BankDetails.type,accountNumber:H.BankDetails.number,ifsc:H.BankDetails.ifsc,isDefault:1,isDeleted:0}},console.log(a),n.prev=7,n.next=10,g.Z.completeprofile(a).then((function(e){return e}));case 10:if(!(i=n.sent).type){n.next=24;break}if("success"!==i.data.Result){n.next=20;break}return n.next=15,g.Z.enableMf(z.email).then((function(e){return e}));case 15:"success"===n.sent.data.Result?(u.Am.success("Mutual Funds Enabled"),o.Z.remove(o.Z.model.clientData),o.Z.remove(o.Z.model.userData)):u.Am.error("Error"),1===("1"===H.taxStatus?H.GuardianPan.kycRegistered:H.panData.kycRegistered)?e.history.push("/start-investing"):e.history.push("/register-KYC"),n.next=22;break;case 20:console.log("ERR : 2",i.data),u.Am.error("Try Again...");case 22:n.next=26;break;case 24:console.log("ERR : 1",i.data),u.Am.error("Try Again...");case 26:n.next=32;break;case 28:n.prev=28,n.t0=n.catch(7),console.log("ERR : c",n.t0),u.Am.error("Try Again...");case 32:case"end":return n.stop()}}),n,null,[[7,28]])})));return function(){return n.apply(this,arguments)}}();return c.useEffect((function(){o.Z.get(o.Z.model.userData).then((function(e){e&&(J(e),e.sign&&(v(e.sign||""),D(e.signID||""),e.sign.startsWith("data:")?R("sign"):R("pick")))})).then((function(){o.Z.get(o.Z.model.user).then((function(e){O(e.userData),ae(e.userData.id),G(!1)}))}))}),[]),A?(0,k.jsx)(y.Z,{}):(0,k.jsxs)("div",{className:"mainContainer",children:[(0,k.jsx)(m.Z,{header:"Activate mutual funds",navigation:e.history}),(0,k.jsx)(p.Z,{now:100,className:"progress-bar-custom"}),(0,k.jsx)("div",{className:"dataContainer",style:{paddingTop:"42px"},children:(0,k.jsxs)("div",{children:["sign"===S?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"header1dark",style:{marginBottom:"6%"},children:"Sign in the box below"}),(0,k.jsxs)("div",{style:{border:"1px dashed "+f.Z.getPropertyValue("--light"),borderRadius:"5px",width:window.innerWidth-33},children:[(0,k.jsx)(d(),{ref:function(e){Q=e},penColor:f.Z.getPropertyValue("--black"),canvasProps:{width:window.innerWidth-33,height:220,className:"sigCanvas"}}),(0,k.jsx)("div",{className:"header1dark",style:{position:"absolute",top:"230px",opacity:.5,textAlign:"center",width:window.innerWidth-33},children:"Sign here"}),(0,k.jsxs)("div",{style:{position:"absolute",top:"340px",textAlign:"center",width:window.innerWidth-33},children:[(0,k.jsx)("button",{style:{backgroundColor:f.Z.getPropertyValue("--primaryGreen"),color:f.Z.getPropertyValue("--darkGreen"),border:"none",borderRadius:"6px",height:"44px",width:"80px",fontSize:"14px"},onClick:function(){return ee()},className:"mx-2",children:"Save"}),(0,k.jsx)("button",{style:{backgroundColor:f.Z.getPropertyValue("--primaryGreen"),color:f.Z.getPropertyValue("--darkGreen"),border:"none",borderRadius:"6px",height:"44px",width:"80px",fontSize:"14px"},onClick:function(){return console.log("clear success!"),Q.clear(),D(""),void v("")},className:"mx-2",children:"Clear"})]})]})]}):(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"header1dark",style:{marginBottom:"6%"},children:"Upload signature"}),""===b||null===b?(0,k.jsx)("div",{style:{borderWidth:1,borderStyle:"dashed",borderColor:f.Z.getPropertyValue("--secondaryGreen"),borderRadius:10,backgroundColor:f.Z.getPropertyValue("--cardColor"),alignItems:"center",padding:"30px",display:"flex",justifyContent:"space-around",marginTop:20},onClick:function(){K.current.click()},children:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("input",{type:"file",accept:"image/*",id:"panfile",ref:K,style:{display:"none"},onChange:function(e){return $(e)}}),(0,k.jsx)("span",{className:"bodyTextLight",style:{color:f.Z.getPropertyValue("--secondaryGreen")},children:"Take a photo or upload an image"}),(0,k.jsx)("img",{style:{color:f.Z.getPropertyValue("--secondaryGreen")},src:h.ZJ})]})}):(0,k.jsxs)("div",{style:{borderWidth:1,borderStyle:"dashed",borderColor:f.Z.getPropertyValue("--secondaryGreen"),borderRadius:10,backgroundColor:f.Z.getPropertyValue("--cardColor"),display:"flex",flexDirection:"column",justifyContent:"space-around",height:"10px !important"},children:[(0,k.jsx)("img",{width:"100%",height:"160",style:{borderRadius:10},src:b}),(0,k.jsx)("div",{style:{alignItems:"center",padding:"10px",display:"flex",justifyContent:"space-around"},onClick:function(){K.current.click(),R("pan")},children:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("input",{type:"file",accept:"image/*",id:"panfile",ref:K,style:{display:"none"},onChange:function(e){return $(e)}}),(0,k.jsx)("span",{className:"bodyTextLight",style:{color:f.Z.getPropertyValue("--secondaryGreen")},children:"Upload a different image"}),(0,k.jsx)("img",{style:{color:f.Z.getPropertyValue("--secondaryGreen")},resizeMode:"contain",src:h.ZJ})]})})]})]}),"sign"===S?(0,k.jsxs)("p",{className:"header2dark mt-3",style:{color:f.Z.getPropertyValue("--secondaryGreen")},onClick:function(){R("pick"),v(""),D("")},children:["Upload signature instead ",(0,k.jsx)(x.Td4,{size:12})]}):(0,k.jsxs)("p",{className:"header2dark mt-3",style:{color:f.Z.getPropertyValue("--secondaryGreen")},onClick:function(){R("sign"),v(""),D("")},children:["Sign it instead ",(0,k.jsx)(x.Td4,{size:12})]})]})}),(0,k.jsx)("div",{className:"footer",children:(0,k.jsx)("button",{className:"solidButton",style:{opacity:B?.4:1},onClick:B?function(){}:function(){return re()},children:"Activate mutual funds now"})})]})}}}]);
//# sourceMappingURL=3497.aea5706c.chunk.js.map