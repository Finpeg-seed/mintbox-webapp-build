"use strict";(self.webpackChunkmintbox_app=self.webpackChunkmintbox_app||[]).push([[9658],{2265:function(e,n,t){t.d(n,{B3:function(){return f},pl:function(){return p}});var r=t(1413),a=t(4165),o=t(5861),i=t(81),s=t(456),c=t(6960),u=t(8848),l="mintbox",d=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n,t,r=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,i.Z.getSmallcasetoken(n).then((function(e){return e}));case 3:if(!(t=e.sent).type){e.next=11;break}return console.log("Initializing with New Token =>>",t.data),e.next=8,u.Z.set(u.Z.model.smallcaseSDKToken,t.data);case 8:window.sc=new window.scDK({gateway:l,smallcaseAuthToken:t.data}),e.next=13;break;case 11:return e.next=13,d();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.get(u.Z.model.smallcaseSDKToken).then(function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===n||1e3*(0,s.Z)(n).exp<(new Date).getTime())){e.next=5;break}return e.next=3,u.Z.get(u.Z.model.user).then(function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Z.get(u.Z.model.clientData).then(function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var o,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t){e.next=23;break}return e.next=3,i.Z.getClient(n.userData.id).then((function(e){return e}));case 3:if(!0!==(o=e.sent).type){e.next=19;break}return s=JSON.parse(o.data),c=s.reduce((function(e,n){return(0,r.Z)((0,r.Z)({},e),n)}),{}),console.log("Get Client API :",c),e.next=10,u.Z.set(u.Z.model.clientData,JSON.stringify(c));case 10:if(!c.SmallcaseInfo.length){e.next=15;break}return e.next=13,d(c.SmallcaseInfo[0].AuthId);case 13:e.next=17;break;case 15:return e.next=17,d();case 17:e.next=21;break;case 19:return e.next=21,d();case 21:case 27:e.next=31;break;case 23:if(!t.SmallcaseInfo.length){e.next=29;break}return console.log("user auth id => ",t.SmallcaseInfo[0].AuthId),e.next=27,d(t.SmallcaseInfo[0].AuthId);case 29:return e.next=31,d();case 31:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){c.Am.error(e)}));case 3:e.next=6;break;case 5:void 0===window.sc?(console.log("Initializing with existing sdktoken -> ",n),window.sc=new window.scDK({gateway:l,smallcaseAuthToken:n})):console.log("smallcase already initialized");case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n,t,r=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,i.Z.getSmallcasetoken(n).then((function(e){return e}));case 3:(t=e.sent).type&&(console.log("New Token =>>",t.data),u.Z.set(u.Z.model.smallcaseSDKToken,t.data),window.sc.init({smallcaseAuthToken:t.data}).then((function(e){console.log("Smallcase init complete",e)})).catch((function(e){console.log(e.message),m()})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n,t,r){var o,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={clientId:n,broker:r,smallcaseAuthToken:t},console.log(o),e.next=4,i.Z.saveSmallCaseAuthId(o).then((function(e){return e}));case 4:if(s=e.sent,console.log(s),!s.type){e.next=18;break}if("failure"!==s.data.Result){e.next=12;break}return console.log("failedddddddd"),e.abrupt("return",!1);case 12:return e.next=14,m(s.data.AuthId);case 14:return console.log("yeahhhhh"),e.abrupt("return",!0);case 16:e.next=19;break;case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}()},3411:function(e,n,t){function r(e){return(e=e>=1e7?"\u20b9 ".concat((e/1e7).toFixed(2)," cr"):e>=1e5?"\u20b9 ".concat((e/1e5).toFixed(2)," lac"):e>=1e3?"\u20b9 ".concat((e/1e3).toFixed(2)," k"):a(e)).replace("-","")}function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=new Intl.NumberFormat("en-IN",{minimumFractionDigits:0,maximumFractionDigits:n}).format(e);return"\u20b9 ".concat(t)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"long",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"short"===n?r(Number(e)):a(Number(e),t)}t.d(n,{A:function(){return o}})},2102:function(e,n,t){t(2791);var r=t(8820),a=t(9126),o=t(3853),i=t(8617),s=t(7811),c=t(184);n.Z=function(e){var n=e.header,t=e.navigation,u=e.screenType,l=e.backAction,d=void 0===l?function(){t.goBack()}:l,f=e.right,m=e.rightAction,p=void 0===m?function(){}:m,h=e.isWatchlisted,g=void 0!==h&&h,x=e.onWatchlistIconClick,v=void 0===x?function(){}:x,y=e.onShareIconClick,b=void 0===y?function(){}:y,Z=e.onHeaderClick,k=void 0===Z?function(){}:Z;return(0,c.jsxs)("div",{className:"mainHeader sticky-top",children:["Home"!==u&&(0,c.jsx)("div",{style:{marginRight:"4%",minWidth:"8%"},children:(0,c.jsx)(o.Ao2,{color:s.Z.getPropertyValue("--secondaryGreen"),size:24,onClick:function(){return d()}})}),(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)("span",{className:"screenTitle",onClick:function(){return k()},children:n})}),(0,c.jsx)("div",{style:{display:"flex"},children:function(){switch(f){case"bookmark-share":return(0,c.jsxs)("span",{children:[g?(0,c.jsx)(a.vw0,{className:"secondaryGreen",size:24,onClick:v}):(0,c.jsx)(a.flH,{className:"secondaryGreen",size:24,onClick:v}),(0,c.jsx)(i.qyl,{className:"secondaryGreen",size:24,style:{marginLeft:"20px"},onClick:b})]});case"tip":return(0,c.jsxs)("span",{className:"header3dark secondaryGreen",onClick:function(){return p()},children:["Tip ",(0,c.jsx)(r.cuw,{size:10})]});default:return f?(0,c.jsx)("span",{className:"greenChipHeader",onClick:function(){p()},children:f}):(0,c.jsx)(c.Fragment,{})}}()})]})}},2785:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(4165),a=t(5861),o=t(8848),i=t(6960),s=t(81),c=t(2265),u=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t,a,i,c,u,l,d,f,m,p,h,g,x,v,y,b;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.navigation,a=n.order,i=n.clientId,c=n.mintboxId,u=n.goalId,l=n.fundCode,d=n.amount,f=n.isSIP,m=n.sipDate,p=n.isUnitsBased,h=n.units,g=n.isInvest,x={},x=g?{clientId:i,mintboxId:c,goalId:Number(u),transactionType:1,fromFundCode:"",toFundCode:l+"",folioNumber:"",sipAmount:f?Number(d):0,units:0,LumpsumAmount:f?0:Number(d),sipDate:f?m:0,investedAmount:a.orderBatches[0].buyAmount,investmentDate:a.orderBatches[0].completedDate}:{clientId:i,mintboxId:c,goalId:Number(u),transactionType:2,fromFundCode:"",toFundCode:l+"",folioNumber:"",sipAmount:0,units:p?Number(h):0,lumpsumAmount:p?0:d,sipDate:0,investedAmount:a.orderBatches[0].sellAmount,investmentDate:a.orderBatches[0].completedDate},console.log("Save trnx log",x),e.next=6,s.Z.saveTransactionLogs(x).then((function(e){return e}));case 6:return v=e.sent,console.log("Save Trx log API response",JSON.stringify(v)),y={clientId:i,mintboxId:c,goalId:Number(u),smallcaseAuthToken:a.smallcaseAuthToken,broker:a.broker,transactionId:a.transactionId,data:{batches:a.orderBatches}},console.log("Save small case order",JSON.stringify(y)),e.next=12,s.Z.saveSmallCaseOrder(i,JSON.stringify(y)).then((function(e){return e}));case 12:if(b=e.sent,console.log("saveSmallCaseOrder API response",b),!b.type){e.next=30;break}return e.next=17,o.Z.remove(o.Z.model.portfolio);case 17:return e.next=19,o.Z.remove(o.Z.model.portfolioXirr);case 19:return e.next=21,o.Z.remove(o.Z.model.portfolioPerformance);case 21:return e.next=23,o.Z.remove(o.Z.model.assetAllocation);case 23:return e.next=25,o.Z.remove(o.Z.model.transactions);case 25:return e.next=27,o.Z.remove(o.Z.model.sip);case 27:t.push("/portfolio/success"),e.next=31;break;case 30:t.push("/portfolio/failed");case 31:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function l(e){return d.apply(this,arguments)}function d(){return d=(0,a.Z)((0,r.Z)().mark((function e(n){var t,l,d,f,m,p,h,g,x,v,y,b;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.navigation,l=n.securities,d=n.amount,f=n.isSIP,m=n.isUnitsBased,p=n.units,h=n.sipDate,g=n.SCREENTYPE,x=n.FUNDDATA,v=n.isInvest,console.log("exec smcs trx",f),y={intent:"TRANSACTION",orderConfig:{type:"SECURITIES",securities:l}},console.log("order",y),e.next=6,s.Z.getSmallcaseTransactionId(y,"",x.MintboxId||0,x.GoalId||0).then((function(e){return e}));case 6:if(!(b=e.sent).type){e.next=24;break}if(console.log("Trx id =>>",b.data.data.transactionId),e.prev=9,void 0!==window.sc){e.next=14;break}return console.log("Initializing Smallcase"),e.next=14,(0,c.B3)();case 14:return e.next=16,window.sc.triggerTransaction({transactionId:b.data.data.transactionId}).then(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),"COMPLETED"!==n.orderBatches[0].status){e.next=4;break}return e.next=4,o.Z.get(o.Z.model.user).then(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(3!==g){e.next=6;break}return e.next=3,u({navigation:t,order:n,clientId:a.userData.id,mintboxId:x.MintboxId||0,goalId:x.GoalId||0,fundCode:x.MintboxId,amount:d,isSIP:f,sipDate:h,isUnitsBased:m,units:p,isInvest:v});case 3:case 9:return e.abrupt("return",e.sent);case 6:if(1!==g){e.next=10;break}return e.next=9,u({navigation:t,order:n,clientId:a.userData.id,mintboxId:x.MintboxId||0,goalId:x.GoalId||0,fundCode:x.FundCode,amount:d,isSIP:f,sipDate:h,isUnitsBased:m,units:p,isInvest:v});case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){if(e.toString().includes("market_closed"))return console.log("mkt closed"),"market_closed";"user_cancelled"!==e.message&&i.Am.error("Something went wrong! Try again.")}));case 16:return e.abrupt("return",e.sent);case 19:e.prev=19,e.t0=e.catch(9),i.Am.error("Something went wrong! Try again.");case 22:e.next=25;break;case 24:console.log("Error getting Transaction Id");case 25:case"end":return e.stop()}}),e,null,[[9,19]])}))),d.apply(this,arguments)}},9658:function(e,n,t){t.r(n),t.d(n,{default:function(){return x}});var r=t(4165),a=t(5861),o=t(9439),i=t(2791),s=t(2102),c=t(7811),u=t(4561),l=t(2373),d=t(8820),f=t(2785),m=t(81),p=t(6960),h=t(3411),g=t(184);function x(e){var n=i.useState(!1),t=(0,o.Z)(n,2),x=t[0],v=t[1],y=e.location.state.fundData,b=e.location.state.constituents,Z=i.useState(),k=(0,o.Z)(Z,2),w=k[0],I=k[1],S=i.useState(!1),N=(0,o.Z)(S,2),C=N[0],A=N[1];i.useEffect((function(){console.log(y),console.log(b)}),[]),i.useEffect((function(){C&&I(y.MintboxBalance)}),[C]);var T=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t,a){var o,i,s,c,u,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.Z.getETFsById(n.toString()).then((function(e){return e}));case 2:if(o=e.sent,console.log(o),!o.type){e.next=28;break}return console.log(o),i={},t.map((function(e){i[e.FundCode]=e.CurrentWeightage/100})),s={},o.data.map((function(e){s[e.Symbol]=e.NAV})),c={weights:i,currentNav:s,investment:a},console.log(c),e.next=14,m.Z.getETFQuantities(JSON.stringify(c)).then((function(e){return e}));case 14:if(u=e.sent,console.log(u),!u.type){e.next=24;break}return l=u.data.Result,l=JSON.parse(l).data,console.log(u),console.log(l),e.abrupt("return",l);case 24:return p.Am.error("Error. Increase redemption amount"),e.abrupt("return",{});case 26:e.next=30;break;case 28:return p.Am.error("Error"),e.abrupt("return",{});case 30:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),j=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(){var t,a,o;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return v(!0),t=b.map((function(e){return e.FundCode})),n.next=4,T(t,b,w);case 4:return a=n.sent,o=Object.entries(a).map((function(e){return{ticker:e[0],quantity:e[1]+"",type:"SELL"}})),console.log(o),n.next=9,(0,f.Z)({navigation:e.history,securities:o,amount:Number(w),isSIP:!1,isUnitsBased:!1,units:0,sipDate:0,SCREENTYPE:3,FUNDDATA:y,isInvest:!1});case 9:v(!1);case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return x?(0,g.jsxs)("div",{style:{flex:1},children:[(0,g.jsx)(s.Z,{header:"Redeem",navigation:e.history}),(0,g.jsx)(u.Z,{})]}):(0,g.jsxs)("div",{className:"mainContainer",children:[(0,g.jsx)(s.Z,{navigation:e.history,header:y.GoalName}),(0,g.jsxs)("div",{className:"dataContainer px-0",children:[(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4%",padding:"4%"},children:[(0,g.jsx)(d.ELj,{size:30,style:{color:c.Z.getPropertyValue("--red")}}),(0,g.jsx)("div",{style:{flex:1},children:(0,g.jsx)("div",{className:"header1faint",style:{color:c.Z.getPropertyValue("--grey")},children:"Redeeming can impact your financial goal success"})})]}),(0,g.jsxs)("div",{style:{margin:"4%"},children:[(0,g.jsx)("div",{className:"header1dark",style:{paddingTop:"4%"},children:"Redemption amount"}),(0,g.jsx)("div",{className:"smallTextLight",children:"Enter the amount to redeem"}),(0,g.jsx)(l.Z,{className:"normalInput rupee",id:"amount",name:"amount",placeholder:"10,000",value:w,allowDecimals:!1,allowNegativeValue:!1,disableAbbreviations:!1,prefix:" ",onValueChange:function(e){A(!1),I(e)},intlConfig:{locale:"en-IN",currency:"INR"}}),(0,g.jsxs)("div",{style:{marginTop:"4%",display:"flex"},children:[(0,g.jsx)("input",{type:"checkbox",id:"checkbox",name:"checkbox",checked:C,onChange:function(){return A(!C)},className:"greenCheckbox"}),(0,g.jsx)("label",{htmlFor:"checkbox",style:{flex:1},children:"Fully redeem this goal"})]})]}),(0,g.jsx)("div",{className:"bodyTextLight",style:{position:"fixed",bottom:70,width:"100%",padding:"2% 4%",borderTop:"1px solid "+c.Z.getPropertyValue("--light")},children:"Note: The actual amount redeemed may be slightly different due to constantly changing prices"}),(0,g.jsx)("div",{className:"footer",children:(0,g.jsx)("button",{className:"outlineButton",style:{color:c.Z.getPropertyValue("--red"),borderColor:c.Z.getPropertyValue("--red")},onClick:function(){w&&0!==w&&(w>y.MintboxBalance?p.Am.error("You can redeem maximum ".concat((0,h.A)(y.MintboxBalance,"long",2))):j())},children:"Confirm and redeem"})})]})]})}},456:function(e,n,t){function r(e){this.message=e}r.prototype=new Error,r.prototype.name="InvalidCharacterError";var a="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var n=String(e).replace(/=+$/,"");if(n.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,a,o=0,i=0,s="";a=n.charAt(i++);~a&&(t=o%4?64*t+a:a,o++%4)?s+=String.fromCharCode(255&t>>(-2*o&6)):0)a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a);return s};function o(e){var n=e.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(a(e).replace(/(.)/g,(function(e,n){var t=n.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t})))}(n)}catch(e){return a(n)}}function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidTokenError",n.Z=function(e,n){if("string"!=typeof e)throw new i("Invalid token specified");var t=!0===(n=n||{}).header?0:1;try{return JSON.parse(o(e.split(".")[t]))}catch(e){throw new i("Invalid token specified: "+e.message)}}},907:function(e,n,t){function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}t.d(n,{Z:function(){return r}})},3878:function(e,n,t){function r(e){if(Array.isArray(e))return e}t.d(n,{Z:function(){return r}})},5267:function(e,n,t){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.d(n,{Z:function(){return r}})},9439:function(e,n,t){t.d(n,{Z:function(){return i}});var r=t(3878);var a=t(181),o=t(5267);function i(e,n){return(0,r.Z)(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(c){s=!0,a=c}finally{try{i||null==t.return||t.return()}finally{if(s)throw a}}return o}}(e,n)||(0,a.Z)(e,n)||(0,o.Z)()}},181:function(e,n,t){t.d(n,{Z:function(){return a}});var r=t(907);function a(e,n){if(e){if("string"===typeof e)return(0,r.Z)(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?(0,r.Z)(e,n):void 0}}}}]);
//# sourceMappingURL=9658.ac7f477f.chunk.js.map